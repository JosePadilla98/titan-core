---
import type { FaqItem } from '@data/faqs';
import {
    getPaddingClass,
    getBackgroundColor,
    getHeadlineColor,
    getTextColor,
    COOL_TEXT_STYLE,
} from '@utils/styleUtils';
import type { PaddingSize, ThemeColor } from '@utils/styleUtils';
import Eyebrow from '@components/ui/Eyebrow.astro';
import Details from '@components/ui/Details.astro';
import ToggleTabs from '@components/ui/ToggleTabs.astro';

export interface FaqTab {
    id: string;
    label: string;
    faqs: FaqItem[];
}

export interface Props {
    content: {
        eyebrow?: string;
        title?: string;
        description?: string;
        tabs: FaqTab[];
    };
    background?: ThemeColor;
    padding?: PaddingSize;
    paddingTop?: PaddingSize;
    paddingBottom?: PaddingSize;
}

const {
    content: { eyebrow, title, description, tabs },
    background = 'base',
} = Astro.props;

const bgColor = getBackgroundColor(background);
const paddingClass = getPaddingClass({
    padding: Astro.props.padding,
    paddingTop: Astro.props.paddingTop,
    paddingBottom: Astro.props.paddingBottom,
});

const headlineColor = getHeadlineColor(background);
const textColor = getTextColor(background);
---

<section class:list={['relative overflow-hidden', bgColor, paddingClass]}>
    <div class="absolute inset-0 bg-gradient-to-br from-primary/5 via-transparent to-secondary/5"></div>
    <div class="site-container px-4 relative z-10">
        {
            (title || description) && (
                <div class="max-w-4xl mx-auto text-center mb-16 lg:mb-20">
                    {eyebrow && <Eyebrow text={eyebrow} background={background} />}
                    {title && (
                        <h2 data-aos="fade-up" class:list={['text-3xl font-bold mb-4', COOL_TEXT_STYLE]}>
                            <span class="">{title}</span>
                        </h2>
                    )}
                    {description && (
                        <p
                            data-aos="fade-up"
                            data-aos-delay="100"
                            class:list={['text-lg lg:text-xl leading-relaxed', textColor, 'opacity-90']}
                        >
                            {description}
                        </p>
                    )}
                </div>
            )
        }

        {tabs.length === 2 && <ToggleTabs tabs={tabs} id="faqs" />}

        <div class="max-w-3xl mx-auto">
            {
                tabs.map((tab, tabIndex) => (
                    <div
                        id={`tab-faqs-${tab.id}`}
                        class:list={['tab-panel', tabIndex === 0 ? 'block' : 'hidden']}
                        data-toggle-id="faqs"
                    >
                        <div class="space-y-4">
                            {tab.faqs.map(({ question, answer, icon }, index) => (
                                <div
                                    class="group relative bg-background-light/50 backdrop-blur-sm rounded-2xl border border-white/10 shadow-lg hover:shadow-xl transition-all duration-300 overflow-hidden"
                                    data-aos="fade-up"
                                    data-aos-delay={index * 100}
                                >
                                    <div class="absolute inset-0 bg-gradient-to-r from-primary/5 to-secondary/5 opacity-0 group-hover:opacity-100 transition-opacity duration-300" />
                                    <Details class="relative z-10 p-6 lg:p-8">
                                        <div slot="heading" class="flex items-center gap-4 pr-12">
                                            {icon && null}
                                            <span
                                                class="text-lg lg:text-xl font-semibold transition-colors duration-300 group-hover:text-primary flex-1"
                                                class:list={[headlineColor]}
                                            >
                                                {question}
                                            </span>
                                        </div>
                                        <div class="overflow-hidden">
                                            <div
                                                class:list={[
                                                    'pt-4 pr-8 text-base leading-relaxed',
                                                    textColor,
                                                    'opacity-90',
                                                ]}
                                            >
                                                {answer}
                                            </div>
                                        </div>
                                    </Details>
                                </div>
                            ))}
                        </div>
                    </div>
                ))
            }
        </div>
    </div>
</section>
