---
import type { FaqItem } from '@data/faqs';
import {
    getPaddingClass,
    getBackgroundColor,
    getHeadlineColor,
    getTextColor,
    COOL_TEXT_STYLE,
} from '@utils/styleUtils';
import type { PaddingSize, ThemeColor } from '@utils/styleUtils';
import Eyebrow from '@components/ui/Eyebrow.astro';
import Details from '@components/ui/Details.astro';
import ToggleTabs from '@components/ui/ToggleTabs.astro';

export interface FaqTab {
    id: string;
    label: string;
    faqs: FaqItem[];
}

export interface Props {
    content: {
        eyebrow?: string;
        title?: string;
        description?: string;
        tabs: FaqTab[];
    };
    background?: ThemeColor;
    padding?: PaddingSize;
    paddingTop?: PaddingSize;
    paddingBottom?: PaddingSize;
}

const {
    content: { eyebrow, title, description, tabs },
    background = 'base',
} = Astro.props;

const bgColor = getBackgroundColor(background);
const paddingClass = getPaddingClass({
    padding: Astro.props.padding,
    paddingTop: Astro.props.paddingTop,
    paddingBottom: Astro.props.paddingBottom,
});

const headlineColor = getHeadlineColor(background);
const textColor = getTextColor(background);
---

<section class:list={['relative', bgColor, paddingClass]}>
    <div class="site-container px-4">
        {
            (title || description) && (
                <div class="max-w-3xl mx-auto text-center mb-12">
                    {eyebrow && <Eyebrow text={eyebrow} background={background} />}
                    {title && (
                        <h2 data-aos="fade-up" class:list={['text-3xl font-bold mb-4', COOL_TEXT_STYLE]}>
                            {title}
                        </h2>
                    )}
                    {description && (
                        <p data-aos="fade-up" class:list={['text-lg', textColor]}>
                            {description}
                        </p>
                    )}
                </div>
            )
        }

        {tabs.length === 2 && <ToggleTabs tabs={tabs} id="faqs" />}

        <div class="max-w-3xl mx-auto">
            {
                tabs.map((tab, tabIndex) => (
                    <div
                        id={`tab-faqs-${tab.id}`}
                        class:list={['tab-panel', tabIndex === 0 ? 'block' : 'hidden']}
                        data-toggle-id="faqs"
                    >
                        <div class="divide-y divide-gray-200">
                            {tab.faqs.map(({ question, answer }, index) => (
                                <Details class="py-6" data-aos="fade-up" data-aos-delay={index * 100}>
                                    <span
                                        slot="heading"
                                        class="pr-8 text-xl font-semibold"
                                        class:list={[headlineColor]}
                                    >
                                        {question}
                                    </span>
                                    <div class="overflow-hidden">
                                        <div class:list={['pt-4 pr-8 text-small', textColor]}>{answer}</div>
                                    </div>
                                </Details>
                            ))}
                        </div>
                    </div>
                ))
            }
        </div>
    </div>
</section>
